<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hourly Planner</title>
  <link href="https://fonts.googleapis.com/css2?family=Faustina&family=Eczar&display=swap" rel="stylesheet" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Fredericka+the+Great&display=swap');
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      background:
        linear-gradient(to right, #ccc 1px, transparent 1px),
        linear-gradient(to bottom, #ccc 1px, transparent 1px);
      background-size: 20px 20px;
      font-family: 'Fredericka the Great', cursive;
      color: #2f3e46;
      background-color: #f9f7f1;
      user-select: none;
    }
    h1 {
      text-align: center;
      margin: 1rem 1rem 0.5rem;
      font-size: 4.5rem;
      letter-spacing: 0.12em;
      color: #1f2d33;
      text-shadow: 1px 1px 0 #f9e5d3;
    }
    h1 small {
      display: block;
      font-size: 2rem;
      font-weight: 400;
      letter-spacing: normal;
      color: #274c77;
    }
    .container {
      flex-grow: 1;
      overflow: auto;
      padding: 0.5rem;
    }
    .calendar {
      display: grid;
      grid-template-columns: 70px repeat(7, 1fr);
      grid-auto-rows: calc(((100vh - 150px) / 19) * 3);
      gap: 8px 8px;
      width: 100vw;
      max-width: 100vw;
      margin: 0 auto;
      overflow-x: auto;
    }
    .day-header {
      position: relative;
      font-weight: 700;
      font-size: 1.8rem;
      text-align: center;
      padding: 6px 4px;
      color: #274c77;
      text-shadow: 1px 1px 0 #f7d1a1;
      box-shadow: 1px 3px 6px rgba(39, 76, 119, 0.15);
      overflow: hidden;
      background-image: none;
    }
    .day-header::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image: url('https://www.stevenprintgallery.com.au/wp-content/uploads/2018/06/the-white-flower.jpg');
      background-size: cover;
      background-position: center;
      opacity: 0.5;
      z-index: -1;
      pointer-events: none;
    }
    .time-label {
      font-weight: 700;
      font-size: 0.9rem;
      font-family: 'Eczar', serif;
      text-align: right;
      padding-right: 8px;
      color: #52796f;
      line-height: 56px;
    }
    .time-block {
      position: relative;
      cursor: pointer;
      background-color: transparent;
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }
    .time-block:hover {
      transform: translateY(-3px);
      box-shadow: 2px 5px 12px rgba(0,0,0,0.25);
      z-index: 2;
      background-color: rgba(255, 255, 255, 0.15) !important;
    }
    .wc1 {
      background-image: url('https://t3.ftcdn.net/jpg/01/19/78/48/360_F_119784892_PRZ2trtQxgXokRg9icHQwShi6T2UreL6.jpg');
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .wc2 {
      background-image: url('https://t4.ftcdn.net/jpg/05/83/96/17/360_F_583961744_0WDje9RZhrWuHTxaWlbNjUSxpQmP6vdS.jpg');
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .wc3 {
      background-image: url('https://media.istockphoto.com/id/1401980312/vector/stipple-illustration-of-cloudscape-background.jpg?s=612x612&w=0&k=20&c=wJ48dX8YlFCF0S8aruISyp4Wh2ggMvjGVihI3IiO4tQ=');
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .wc4 {
      background-image: url('https://t3.ftcdn.net/jpg/05/00/84/22/360_F_500842228_mff5kYpDZyOgZPYhuMHdmGIhaqITWGWy.jpg');
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .wc5 {
      background-image: url('https://img.freepik.com/free-vector/abstract-soft-yellow-watercolor-texture-background-vector_1055-18183.jpg');
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .wc6 {
      background-image: url('https://cdn.pixabay.com/photo/2017/06/19/14/22/watercolor-2419495_960_720.jpg');
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .wc7 {
      background-image: url('https://st4.depositphotos.com/23035388/30476/i/450/depositphotos_304769168-stock-photo-abstract-dark-grey-watercolor-background.jpg');
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .wc1, .wc2, .wc3, .wc4, .wc5, .wc6, .wc7 {
      background-size: cover;
      background-position: center;
      color: #fff;
    }
    .event {
      position: absolute;
      top: 4px;
      left: 6px;
      right: 6px;
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 0.85rem;
      font-family: 'Faustina', serif;
      box-shadow: 0 3px 6px rgba(0,0,0,0.15);
      z-index: 10;
      cursor: pointer;
      backdrop-filter: blur(3px);
      -webkit-backdrop-filter: blur(3px);
      border: 1px solid transparent;
      user-select: text;
    }
    .event.category-personal {
      background: rgba(255, 255, 253, 0.7);
      color: #333;
      border-color: #fbcf41;
    }
    .event.category-study {
      background: rgba(251, 207, 65, 0.7);
      color: #333;
      border-color: #f6a230;
    }
    .event.category-other {
      background: rgba(246, 162, 48, 0.7);
      color: #fff;
      border-color: #5966b1;
    }
    .event.category-work {
      background: rgba(89, 102, 177, 0.7);
      color: #fff;
      border-color: #36448b;
    }
    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 0.5rem;
    }
    button {
      font-family: 'Fredericka the Great', cursive;
      font-size: 1.1rem;
      padding: 0.4rem 1rem;
      border: 2px solid #274c77;
      background-color: #f9f7f1;
      color: #274c77;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover:not(:disabled) {
      background-color: #e6dfd4;
    }
    button:disabled {
      opacity: 0.5;
      cursor: default;
    }
    #eventModal {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.4);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }
    #eventModal .modal-content {
      background: #fff;
      padding: 1rem;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      font-family: 'Faustina', serif;
    }
    #eventModal label {
      display: block;
      margin-top: 0.5rem;
    }
    #eventModal input, #eventModal select {
     

  const eventCategorySelect = document.getElementById('eventCategory');
  const deleteEventBtn = document.getElementById('deleteEventBtn');
  const cancelEventBtn = document.getElementById('cancelEventBtn');

  let currentWeekStart = getStartOfWeek(new Date());
  let events = loadEvents();

  // Helper: get Sunday of the week for a given date
  function getStartOfWeek(date) {
    const d = new Date(date);
    d.setHours(0, 0, 0, 0);
    const day = d.getDay();
    d.setDate(d.getDate() - day);
    return d;
  }

  // Helper: format date as YYYY-MM-DD
  function formatDate(date) {
    return date.toISOString().slice(0, 10);
  }

  // Load events from localStorage
  function loadEvents() {
    try {
      const data = localStorage.getItem('hourlyPlannerEvents');
      return data ? JSON.parse(data) : [];
    } catch {
      return [];
    }
  }

  // Save events to localStorage
  function saveEvents() {
    localStorage.setItem('hourlyPlannerEvents', JSON.stringify(events));
  }

  // Render calendar grid
  function renderCalendar() {
    grid.innerHTML = '';

    // First cell empty for time labels header
    const emptyHeader = document.createElement('div');
    emptyHeader.className = 'day-header';
    grid.appendChild(emptyHeader);

    // Day headers with background images
    for (let i = 0; i < 7; i++) {
      const dayHeader = document.createElement('div');
      dayHeader.className = 'day-header wc' + ((i % 7) + 1);
      const date = new Date(currentWeekStart);
      date.setDate(date.getDate() + i);
      dayHeader.textContent = `${daysOfWeek[date.getDay()]}\n${date.toLocaleDateString(undefined, {month: 'short', day: 'numeric'})}`;
      grid.appendChild(dayHeader);
    }

    // For each hour, create row: time label + 7 day cells
    for (let h = 0; h < hoursCount; h++) {
      const hourLabel = document.createElement('div');
      hourLabel.className = 'time-label';
      hourLabel.textContent = formatHour(hoursStart + h);
      grid.appendChild(hourLabel);

      for (let d = 0; d < 7; d++) {
        const cell = document.createElement('div');
        cell.className = 'time-block wc' + ((d % 7) + 1);
        const cellDate = new Date(currentWeekStart);
        cellDate.setDate(cellDate.getDate() + d);
        cellDate.setHours(hoursStart + h, 0, 0, 0);

        cell.dataset.date = formatDate(cellDate);
        cell.dataset.hour = hoursStart + h;

        // Show events for this date+hour
        const cellEvents = events.filter(e => e.date === cell.dataset.date && e.hour === cell.dataset.hour);
        cellEvents.forEach(e => {
          const evDiv = document.createElement('div');
          evDiv.className = 'event category-' + e.category;
          evDiv.textContent = e.title;
          evDiv.dataset.eventId = e.id;
          evDiv.title = `${e.title} (${e.category})`;
          evDiv.addEventListener('click', (evt) => {
            evt.stopPropagation();
            openEventModal(e);
          });
          cell.appendChild(evDiv);
        });

        cell.addEventListener('click', () => openEventModal({
          id: null,
          date: cell.dataset.date,
          hour: cell.dataset.hour,
          title: '',
          category: ''
        }));

        grid.appendChild(cell);
      }
    }
  }

  // Format hour number to readable format (e.g., 6 => 6:00 AM)
  function formatHour(hour) {
    const suffix = hour >= 12 ? 'PM' : 'AM';
    const hour12 = hour % 12 === 0 ? 12 : hour % 12;
    return `${hour12}:00 ${suffix}`;
  }

  // Open modal with event data (empty for new)
  function openEventModal(event) {
    eventIdInput.value = event.id ?? '';
    eventTitleInput.value = event.title ?? '';
    eventCategorySelect.value = event.category ?? '';
    eventForm.dataset.date = event.date;
    eventForm.dataset.hour = event.hour;

    deleteEventBtn.style.display = event.id ? 'inline-block' : 'none';

    eventModal.style.display = 'flex';
    eventTitleInput.focus();
  }

  // Close modal
  function closeEventModal() {
    eventModal.style.display = 'none';
  }

  // Add or update event
  function saveEvent(event) {
    event.preventDefault();
    const id = eventIdInput.value;
    const title = eventTitleInput.value.trim();
    const category = eventCategorySelect.value;
    const date = eventForm.dataset.date;
    const hour = parseInt(eventForm.dataset.hour, 10);

    if (!title || !category) return;

    if (id) {
      // Update existing
      const idx = events.findIndex(e => e.id === id);
      if (idx >= 0) {
        events[idx].title = title;
        events[idx].category = category;
      }
    } else {
      // New event - generate unique id
      const newId = 'e' + Date.now() + Math.floor(Math.random() * 1000);
      events.push({id: newId, title, category, date, hour});
    }

    saveEvents();
    renderCalendar();
    closeEventModal();
  }

  // Delete event
  function deleteEvent() {
    const id = eventIdInput.value;
    if (!id) return;
    events = events.filter(e => e.id !== id);
    saveEvents();
    renderCalendar();
    closeEventModal();
  }

  // Event listeners
  eventForm.addEventListener('submit', saveEvent);
  deleteEventBtn.addEventListener('click', deleteEvent);
  cancelEventBtn.addEventListener('click', closeEventModal);
  eventModal.addEventListener('click', e => {
    if (e.target === eventModal) closeEventModal();
  });

  // Navigate weeks
  prevWeekBtn.addEventListener('click', () => {
    currentWeekStart.setDate(currentWeekStart.getDate() - 7);
    renderCalendar();
  });
  nextWeekBtn.addEventListener('click', () => {
    currentWeekStart.setDate(currentWeekStart.getDate() + 7);
    renderCalendar();
  });

  // Initial render
  renderCalendar();

})();



